<?xml version="1.0" encoding="UTF-8"?>
<StructureDefinition
    xmlns="http://hl7.org/fhir">
    <id value="SDOHCC-ObservationRace"/>
    <meta>
        <versionId value="14"/>
        <lastUpdated value="2021-11-22T23:07:46.413+00:00"/>
        <source value="#Uh0A6Lww79trsoWE"/>
    </meta>
    <url value="http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationRace"/>
    <name value="SDOHCCObservationRace"/>
    <title value="SDOHCC Observation Race"/>
    <status value="draft"/>
    <description value="Profile for observations about race using Office of Management and Budget (OMB) race category codes and CDC race codes. This profile is intended for draft use only. The Cross-Group Projects work group granted an exception to US Core on 11/18/2021 - Jira ticket 34245."/>
    <fhirVersion value="4.0.1"/>
    <kind value="resource"/>
    <abstract value="false"/>
    <type value="Observation"/>
    <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Observation"/>
    <derivation value="constraint"/>
    <differential>
        <element id="Observation">
            <path value="Observation"/>
            <short value="Race observation"/>
            <definition value="For observations about the race of an individual."/>
            <constraint>
                <key value="SDOH-Obs-1"/>
                <severity value="error"/>
                <human value="Must have either a dataAbsentReason or at least one of the defined race components but not both"/>
                <expression value="dataAbsentReason.exists() xor component.where(code.coding.where(system='http://loinc.org' and code='72826-1')).exists()"/>
                <xpath value="true()"/>
                <source value="http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationRace"/>
            </constraint>
            <constraint>
                <key value="SDOH-Obs-2"/>
                <severity value="error"/>
                <human value="Must have either performer or derivedFrom."/>
                <expression value="performer.exists() or derivedFrom.exists()"/>
                <xpath value="true()"/>
                <source value="http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationRace"/>
            </constraint>
            <constraint>
                <key value="SDOH-Obs-3"/>
                <severity value="error"/>
                <human value="Either subject or extension-Observation.subject must exist but not both."/>
                <expression value="subject.exists() xor extension('http://hl7.org/fhir/5.0/StructureDefinition/extension-Observation.subject').exists()"/>
                <xpath value="true()"/>
                <source value="http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationRace"/>
            </constraint>
            <constraint>
                <key value="SDOH-Obs-4"/>
                <severity value="error"/>
                <human value="focus is only allowed if subject is present."/>
                <expression value="focus.exists() implies subject.exists()"/>
                <xpath value="true()"/>
                <source value="http://hl7.org/fhir/us/sdoh-clinicalcare/StructureDefinition/SDOHCC-ObservationRace"/>
            </constraint>
        </element>
        <element id="Observation.extension">
            <path value="Observation.extension"/>
            <slicing>
                <discriminator>
                    <type value="value"/>
                    <path value="url"/>
                </discriminator>
                <rules value="open"/>
            </slicing>
            <min value="0"/>
        </element>
        <element id="Observation.extension:OtherSubject">
            <path value="Observation.extension"/>
            <sliceName value="OtherSubject"/>
            <min value="0"/>
            <max value="1"/>
            <type>
                <code value="Extension"/>
                <profile value="http://hl7.org/fhir/5.0/StructureDefinition/extension-Observation.subject"/>
            </type>
            <condition value="SDOH-Obs-3"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.extension:OtherSubject.value[x]">
            <path value="Observation.extension.value[x]"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/us/core/StructureDefinition/us-core-practitioner"/>
            </type>
        </element>
        <element id="Observation.status">
            <path value="Observation.status"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.code">
            <path value="Observation.code"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://loinc.org"/>
                    <code value="72826-1"/>
                </coding>
            </patternCodeableConcept>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.subject">
            <path value="Observation.subject"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient"/>
            </type>
            <condition value="SDOH-Obs-3"/>
            <condition value="SDOH-Obs-4"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.focus">
            <path value="Observation.focus"/>
            <max value="1"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/StructureDefinition/RelatedPerson"/>
            </type>
            <condition value="SDOH-Obs-4"/>
        </element>
        <element id="Observation.performer">
            <path value="Observation.performer"/>
            <max value="1"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.value[x]">
            <path value="Observation.value[x]"/>
            <max value="0"/>
        </element>
        <element id="Observation.dataAbsentReason">
            <path value="Observation.dataAbsentReason"/>
            <comment value="Null or exceptional values can be represented two ways in FHIR Observations.  One way is to simply include them in the value set and represent the exceptions in the value.  &#xA;&#xA;The alternate way is to use the value element for actual observations and use the explicit dataAbsentReason element to record exceptional values."/>
            <condition value="SDOH-Obs-1"/>
            <mustSupport value="true"/>
            <binding>
                <strength value="required"/>
                <valueSet value="http://hl7.org/fhir/us/sdoh-clinicalcare/ValueSet/SDOHCC-ValueSetObservationDataAbsentReason"/>
            </binding>
        </element>
        <element id="Observation.bodySite">
            <path value="Observation.bodySite"/>
            <max value="0"/>
        </element>
        <element id="Observation.method">
            <path value="Observation.method"/>
            <min value="1"/>
            <mustSupport value="true"/>
            <binding>
                <strength value="extensible"/>
                <valueSet value="http://hl7.org/fhir/us/sdoh-clinicalcare/ValueSet/SDOHCC-ValueSetObservationMethod"/>
            </binding>
        </element>
        <element id="Observation.specimen">
            <path value="Observation.specimen"/>
            <max value="0"/>
        </element>
        <element id="Observation.referenceRange">
            <path value="Observation.referenceRange"/>
            <max value="0"/>
        </element>
        <element id="Observation.derivedFrom">
            <path value="Observation.derivedFrom"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/StructureDefinition/DocumentReference"/>
                <targetProfile value="http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse"/>
                <targetProfile value="http://hl7.org/fhir/StructureDefinition/Observation"/>
                <targetProfile value="http://hl7.org/fhir/StructureDefinition/MolecularSequence"/>
            </type>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component">
            <path value="Observation.component"/>
            <slicing>
                <discriminator>
                    <type value="pattern"/>
                    <path value="code"/>
                </discriminator>
                <discriminator>
                    <type value="type"/>
                    <path value="value"/>
                </discriminator>
                <discriminator>
                    <type value="value"/>
                    <path value="value"/>
                </discriminator>
                <rules value="open"/>
            </slicing>
            <definition value="Some observations have multiple component observations.  These component observations are expressed as separate code value pairs that share the same attributes."/>
            <requirements value="Component observations share the same attributes in the Observation resource as the primary observation and are always treated a part of a single observation (they are not separable)."/>
            <condition value="SDOH-Obs-1"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:RaceDescription">
            <path value="Observation.component"/>
            <sliceName value="RaceDescription"/>
            <definition value="Some observations have multiple component observations.  These component observations are expressed as separate code value pairs that share the same attributes."/>
            <requirements value="Component observations share the same attributes in the Observation resource as the primary observation and are always treated a part of a single observation (they are not separable)."/>
            <max value="1"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:RaceDescription.code">
            <path value="Observation.component.code"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://loinc.org"/>
                    <code value="72826-1"/>
                </coding>
            </patternCodeableConcept>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:RaceDescription.value[x]">
            <path value="Observation.component.value[x]"/>
            <min value="1"/>
            <type>
                <code value="string"/>
            </type>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:RaceDescription.dataAbsentReason">
            <path value="Observation.component.dataAbsentReason"/>
            <max value="0"/>
        </element>
        <element id="Observation.component:RaceDescription.referenceRange">
            <path value="Observation.component.referenceRange"/>
            <max value="0"/>
        </element>
        <element id="Observation.component:Race">
            <path value="Observation.component"/>
            <sliceName value="Race"/>
            <definition value="Some observations have multiple component observations.  These component observations are expressed as separate code value pairs that share the same attributes."/>
            <max value="5"/>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:Race.code">
            <path value="Observation.component.code"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://loinc.org"/>
                    <code value="72826-1"/>
                </coding>
            </patternCodeableConcept>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:Race.value[x]">
            <path value="Observation.component.value[x]"/>
            <short value="Race category codes"/>
            <definition value="Office of Management and Budget (OMB) codes for race categories."/>
            <min value="1"/>
            <type>
                <code value="CodeableConcept"/>
            </type>
            <mustSupport value="true"/>
            <binding>
                <strength value="required"/>
                <description value="Codes for the five OMB race categories"/>
                <valueSet value="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.2074.1.1.3"/>
            </binding>
        </element>
        <element id="Observation.component:Race.dataAbsentReason">
            <path value="Observation.component.dataAbsentReason"/>
            <max value="0"/>
        </element>
        <element id="Observation.component:Race.referenceRange">
            <path value="Observation.component.referenceRange"/>
            <max value="0"/>
        </element>
        <element id="Observation.component:DetailedRace">
            <path value="Observation.component"/>
            <sliceName value="DetailedRace"/>
            <definition value="Some observations have multiple component observations.  These component observations are expressed as separate code value pairs that share the same attributes.  Examples include systolic and diastolic component observations for blood pressure"/>
            <requirements value="Component observations share the same attributes in the Observation resource as the primary observation and are always treated a part of a single observation (they are not separable)."/>
        </element>
        <element id="Observation.component:DetailedRace.code">
            <path value="Observation.component.code"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://loinc.org"/>
                    <code value="72826-1"/>
                </coding>
            </patternCodeableConcept>
            <mustSupport value="true"/>
        </element>
        <element id="Observation.component:DetailedRace.value[x]">
            <path value="Observation.component.value[x]"/>
            <short value="Detailed race codes"/>
            <min value="1"/>
            <type>
                <code value="CodeableConcept"/>
            </type>
            <mustSupport value="true"/>
            <binding>
                <strength value="required"/>
                <description value="CDC race codes that are under one of the 5 OMB ethnicity category codes"/>
                <valueSet value="http://hl7.org/fhir/us/core/ValueSet/detailed-race"/>
            </binding>
        </element>
        <element id="Observation.component:DetailedRace.dataAbsentReason">
            <path value="Observation.component.dataAbsentReason"/>
            <max value="0"/>
        </element>
        <element id="Observation.component:DetailedRace.referenceRange">
            <path value="Observation.component.referenceRange"/>
            <max value="0"/>
        </element>
    </differential>
</StructureDefinition>